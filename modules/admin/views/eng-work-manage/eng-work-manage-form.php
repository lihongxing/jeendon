<?phpuse yii\helpers\Html;use app\common\core\ConstantHelper;$this->title = Yii::t('admin', 'workmanageinfo');$this->params['breadcrumbs'][] = ['label' => Yii::t('admin', 'workmanage'), 'url' => ['eng-list']];$this->params['breadcrumbs'][] = $this->title;use yii\helpers\Url;?><script type="text/javascript" src="/admin/js/tooltipbox.js"></script><link rel="stylesheet" href="/admin/plugins/iCheck/all.css"><link rel="stylesheet" src="/admin/bootstrap/css/bootstrap-select.css"><!--<script type="text/javascript" src="/admin/bootstrap/js/bootstrap-select.js">--><section class="content">    <div class="row">        <div class="col-md-12">            <!-- Horizontal Form -->            <div class="box box-primary">                <div class="box-header with-border">                    <h3 class="box-title"><?=$this->title ?></h3>                </div><!-- /.box-header -->                <!-- form start -->                <div class="box-body">                    <form action="<?=Url::toRoute('/admin/eng-manage/eng-manage-form')?>" method="post" class="form-horizontal" role="form" enctype="multipart/form-data" id="form">                        <div class="form-group">                            <label class="col-xs-12 col-sm-2 col-md-2 col-lg-2 control-label">作品名称</label>                            <div class="col-sm-9 col-xs-12">                                <input name="Work[username]" id="work_name" class="form-control" value="<?=$Work['work_name']?>" type="text">                            </div>                        </div>                        <div class="form-group">                            <label class="col-xs-12 col-sm-2 col-md-2 col-lg-2 control-label">作品图片</label>                            <div class="col-sm-9 col-xs-12">                                <div class="input-group form-group">                                    <input type="text" name="Work[work_pic_url]" class="form-control" value="<?= $Work['work_pic_url']?>" data-id="works">                                    <span class="input-group-addon btn nav-imgp" style="border-left: 0px; cursor: pointer;" data-id="works">预览图片</span>                                    <span class="input-group-addon btn btn-default nav-imgc" style="background: #fff;" data-id="works">选择图片</span>                                </div>                                <div class="input-group " style="margin-top:.5em;">                                    <img src="<?= empty($Work['work_pic_url']) ? '/resource/images/nopic.jpg' : $Work['work_pic_url']?>" data-id="works" onerror="this.src='/resource/images/nopic.jpg'; this.title='图片未找到.'" class="img-responsive img-thumbnail" width="150">                                    <em class="close" style="position:absolute; top: 0px; right: -14px;" title="删除这张图片" onclick="deleteImage(this)">×</em>                                </div>                            </div>                        </div>                        <div class="form-group">                            <label class="col-xs-12 col-sm-2 col-md-2 col-lg-2 control-label">类别</label>                            <div class="col-sm-10 col-xs-12">                                <div class="row row-fix">                                    <div class="col-xs-4 col-sm-3">                                        <select id="work_mold_type" name="work_mold_type" class="form-control">                                            <?php foreach(\app\common\core\ConstantHelper::$task_mold_type['data'] as $key => $val){?>                                            <option <?php if($key == $item['work_mold_type']){?> selected="selected" <?php }?> ><?= $val?></option>                                            <?php }?>                                        </select>&nbsp;&nbsp;                                    </div>                                </div>                            </div>                        </div>                        <div class="form-group">                            <label class="col-xs-12 col-sm-3 col-md-2 control-label">工程师信息</label>                            <div class="col-sm-9 col-xs-12">                                <div class="panel panel-default">                                    <div class="panel-heading">                                        工程师信息                                    </div>                                    <ul class="list-group">                                        <li class="list-group-item">                                            <div class="form-group">                                                <div class="col-sm-12">                                                    <div class="input-group form-group">                                                        <span class="input-group-addon">用户名：</span>                                                        <input name="Work[username]" class="form-control judge" id="username" value="<?= $Work['username']?>" type="text">                                                    </div>                                                </div>                                            </div>                                            <div class="form-group">                                                <div class="col-sm-12">                                                    <div class="input-group form-group">                                                        <span class="input-group-addon">头像</span>                                                        <input type="text" name="Work[eng_head_img]" class="form-control" value="<?= $Work['eng_head_img']?>" data-id="just">                                                        <span class="input-group-addon btn nav-imgp" style="border-left: 0px; cursor: pointer;" data-id="just">预览图片</span>                                                        <span class="input-group-addon btn btn-default nav-imgc" style="background: #fff;" data-id="just">选择图片</span>                                                    </div>                                                    <div class="input-group " style="margin-top:.5em;">                                                        <img src="<?= empty($Work['eng_head_img']) ? '/resource/images/nopic.jpg' : $Work['eng_head_img']?>" data-id="just" onerror="this.src='/resource/images/nopic.jpg'; this.title='图片未找到.'" class="img-responsive img-thumbnail" width="150">                                                        <em class="close" style="position:absolute; top: 0px; right: -14px;" title="删除这张图片" onclick="deleteImage(this)">×</em>                                                    </div>                                                </div>                                            </div>                                        </li>                                    </ul>                                    <script type="text/javascript">                                        $("#eng_examine_type").change(function(){                                            if($(this).val() == 1){                                                $("#persion").show();                                                $("#company").hide();                                                $("#none").hide();                                            }else if($(this).val() == 2){                                                $("#persion").hide();                                                $("#company").show();                                                $("#none").hide();                                            }else{                                                $("#none").show();                                                $("#company").hide();                                                $("#none").hide();                                            }                                        });                                        $(".nav-imgp").click(function(){                                            var id = $(this).data("id");                                            var imgurl = $("input[data-id="+id+"]").val();                                            if(imgurl){                                                $("#imgp").attr("src",imgurl);                                                $("#modal-imgp").modal();                                            }else{                                                alert("您还没选择图片哦！");                                            }                                        });                                        $(document).on("click",".nav-imgc",function(){                                            var id = $(this).data("id");                                            require(['jquery', 'util'], function($, util){                                                util.image('',function(data){                                                    $("input[data-id="+id+"]").val(data.url);                                                    $("img[data-id="+id+"]").attr("src",data.url);                                                });                                            });                                        });                                    </script>                                </div>                            </div>                        </div>                        <div class="form-group">                            <label class="col-xs-12 col-sm-2 col-md-2 col-lg-2 control-label">添加时间</label>                            <div class="col-sm-9 col-xs-12">                                <input name="Work[work_add_time]" id="work_add_time" class="form-control" value="<?= date('Y-m-d H:i:s',$Work['work_add_time'])?>" type="text">                            </div>                        </div>                        <?php if(!empty($Work['work_examine_add_time'])){?>                        <div class="form-group">                            <label class="col-xs-12 col-sm-2 col-md-2 col-lg-2 control-label">审核时间</label>                            <div class="col-sm-9 col-xs-12">                                <input name="Work[work_examine_add_time]" id="work_examine_add_time" class="form-control" value="<?= date('Y-m-d H:i:s',$Work['work_examine_add_time'])?>" type="text">                            </div>                        </div>                        <?php }?>                        <div class="form-group">                            <label class="col-xs-12 col-sm-3 col-md-2 control-label">审核状态</label>                            <div class="col-sm-9 col-xs-12">                                <label class="radio-inline"><input name="Work[eng_examine_status]" value="100" <?php if($Work['work_examine_status'] == 100){?> checked="" <?php }?> type="radio">审核通过</label>                                <label class="radio-inline"><input name="Work[eng_examine_status]" value="101" <?php if($Work['work_examine_status'] == 101){?> checked="" <?php }?> type="radio">审核未通过</label>                                <label class="radio-inline"><input name="Work[eng_examine_status]" value="102" <?php if($Work['work_examine_status'] == 102){?> checked="" <?php }?> type="radio">未审核</label>                            </div>                        </div>                        <div class="form-group">                            <div class="col-sm-offset-2 col-md-offset-2 col-lg-offset-1 col-xs-12 col-sm-9 col-md-10 col-lg-21">                                <input type="button" class="btn btn-default col-lg-2" value="返回列表"                                       style="margin-left:10px;" onclick="history.back()" name="back">                            </div>                        </div>                    </form>                </div>            </div><!-- /.box -->        </div>    </div>    <div id="modal-imgp" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">        <div class="modal-dialog">            <div class="modal-content">                <div class="modal-header">                    <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>                    <h4>图片预览</h4>                </div>                <div class="modal-body">                    <img src="" id="imgp" style="width:100%;" />                </div>            </div>        </div>    </div></section><script>    $(function () {        require(["validation", "validation-methods"], function (validate) {            $("#form").validate({                ignore: ".ignore",                rules: {                    "Work[username]": {                        required: true,                        rangelength:[2,16],                        remote:{                            url:"/admin/eng-manage/check-eng.html",//后台处理程序                            data:{                                _csrf:function(){                                    return "<?= yii::$app->request->getCsrfToken()?>";                                },                                empid:function(){                                    return $("#eng_id").val();                                }                            },                            type:"post",                        }                    },                    "Work[eng_phone]": {                        required: true,                        isMobile: true,                        remote:{                            url:"/admin/eng-manage/check-eng.html",//后台处理程序                            data:{                                _csrf:function(){                                    return "<?= yii::$app->request->getCsrfToken()?>";                                },                                empid:function(){                                    return $("#eng_id").val();                                }                            },                            type:"post",                        }                    },                    "Work[eng_email]": {                        required: true,                    }                },                messages: {                    "Work[username]": {                        required: "请输入工程师用户名",                        rangelength: "请输入范围在 {0} 到 {1} 之间的用户名",                        remote: "工程师用户名已经存在"                    },                    "Work[eng_phone]": {                        required: "请输入工程师手机号码",                        isMobile: "输入正确的手机号码",                        remote: "手机号码已经存在"                    },                    "Work[eng_email]": {                        required: "请输入工程师邮箱"                    }                },                errorClass: "has-error",            });        });    });</script>